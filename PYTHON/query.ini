[query]
query_1_1 = SELECT FT.ID_DEVELOPER, COUNT(0) AS TOTAL, CONVERT(DECIMAL(18,2), SUM(EFFORT))  EFFORT , CONVERT(DECIMAL(18,2),SUM(ISNULL(EFFORT,0)) /   CONVERT(DECIMAL(18,2), COUNT(0))) AS INDEX_EFFORT FROM FT_TECHNICALDEBT FT (NOLOCK)  JOIN  DM_PROJECT P (NOLOCK)  ON FT.ID_PROJECT = P.ID_PROJECT WHERE ID_ACTION = 1   AND ID_TDITEM = 1 AND IGNORE = 0 GROUP BY FT.ID_DEVELOPER ORDER BY 2 DESC
query_1_2 = SELECT  FT.ID_DEVELOPER, COUNT(0) AS TOTAL  FROM FT_TECHNICALDEBT FT (NOLOCK)  JOIN  DM_PROJECT P (NOLOCK) ON FT.ID_PROJECT = P.ID_PROJECT WHERE ID_ACTION = 2   AND ID_TDITEM = 1  GROUP BY FT.ID_DEVELOPER ORDER BY 2 DESC
query_2_1 = SELECT DISTINCT  r.RULE_DESCRIPTION + ' - ' + R.RULE_NAME  AS RULE_NAME , COUNT(0) AS QUANTIDADE , SUM (ISNULL(EFFORT,0)) AS ESFORCO ,  CONVERT(DECIMAL(18,2),   CONVERT(DECIMAL(18,2), SUM (ISNULL(EFFORT,0))) / CONVERT(DECIMAL(18,2), COUNT(0))) AS INDICE_ESFORCO      FROM FT_TECHNICALDEBT FT (NOLOCK) JOIN DM_RULE R (NOLOCK)  ON R.id_RULE = FT.ID_RULE WHERE ID_ACTION = 1 AND ID_TDITEM = 1 AND IGNORE =0 GROUP BY  r.RULE_DESCRIPTION + ' - ' + R.RULE_NAME ORDER BY 2 DESC
query_2_1_B = SELECT DISTINCT  r.RULE_DESCRIPTION + ' - ' + R.RULE_NAME  AS RULE_NAME , COUNT(0) AS QUANTIDADE , SUM (ISNULL(EFFORT,0)) AS ESFORCO , CONVERT(DECIMAL(18,2),   CONVERT(DECIMAL(18,2), SUM (EFFORT)) / COUNT(0)) AS INDICE_ESFORCO     FROM FT_TECHNICALDEBT FT (NOLOCK) JOIN DM_RULE R (NOLOCK)  ON R.id_RULE = FT.ID_RULE WHERE ID_ACTION = 1 AND ID_TDITEM = 1 AND IGNORE =  0 AND ID_DEVELOPER = {desenvolvedor} GROUP BY  r.RULE_DESCRIPTION + ' - ' + R.RULE_NAME ORDER BY 2 DESC
query_2_1_C = SELECT   CONVERT(VARCHAR, r.ID_SEVERITY) + '-' + R.DESCRIPTION  AS SEVERIDADE , COUNT(0) AS QUANTIDADE , SUM (ISNULL(EFFORT,0)) AS ESFORCO , CONVERT(DECIMAL(18,2),  CONVERT(DECIMAL(18,2),  SUM (ISNULL(EFFORT,0))) / CONVERT(DECIMAL(18,2), COUNT(0)))AS INDICE_ESFORCO FROM FT_TECHNICALDEBT FT (NOLOCK) JOIN DM_SEVERITY R (NOLOCK)  ON R.ID_SEVERITY = FT.ID_SEVERITY WHERE ID_ACTION = 1 AND ID_TDITEM = 1 AND IGNORE = 0 GROUP BY CONVERT(VARCHAR, r.ID_SEVERITY) + '-' + R.DESCRIPTION ORDER BY 1 ASC
query_2_1_D = SELECT   CONVERT(VARCHAR, r.ID_SEVERITY) + '-' + R.DESCRIPTION  AS SEVERIDADE , COUNT(0) AS QUANTIDADE , SUM (ISNULL(EFFORT,0)) AS ESFORCO , CONVERT(DECIMAL(18,2),  CONVERT(DECIMAL(18,2),  SUM (ISNULL(EFFORT,0))) / CONVERT(DECIMAL(18,2), COUNT(0)))AS INDICE_ESFORCO FROM FT_TECHNICALDEBT FT (NOLOCK) JOIN DM_SEVERITY R (NOLOCK)  ON R.ID_SEVERITY = FT.ID_SEVERITY WHERE ID_ACTION = 1 AND ID_TDITEM = 1 AND IGNORE = 0  AND ID_DEVELOPER = {desenvolvedor} GROUP BY CONVERT(VARCHAR, r.ID_SEVERITY) + '-' + R.DESCRIPTION ORDER BY 1 ASC
query_3_1 = SELECT   R.ID_RULE, REPLACE(R.RULE_DESCRIPTION,'SEE','') + ' - ' +REPLACE( R.RULE_NAME,'SEE','') AS RULE_DESCRIPTION  , 1 as VALOR, ID_COMMIT  FROM FT_TECHNICALDEBT FT JOIN DM_VERSION V ON FT.ID_VERSION = V.ID_VERSION   JOIN DM_RULE R ON R.ID_RULE = FT.ID_RULE WHERE ID_ACTION = 1   AND ID_TDITEM = 1   AND EFFORT IS NOT NULL  AND IGNORE = 0    ORDER BY  2,1
query_4_1 = SELECT ISNULL(SUM(TOTAL_ADD_CS_ALL_DEV),0) TOTAL_ADD_CS_ALL_DEV, ISNULL(SUM(TOTAL_ADD_CS_DEV),0) TOTAL_ADD_CS_DEV, DATA  FROM ( SELECT  TOTAL_ADD_CS_ALL_DEV , TOTAL_ADD_CS_DEV,  CONVERT(char(10),CONVERT(DATETIME,SUBSTRING( CONVERT(VARCHAR, T.DATE,112),0,7)+'01',113),126) as DATA   FROM DM_TIME T JOIN ( select MIN(ID_TIME) ID_TIME_MIN ,MAX(ID_TIME) ID_TIME_MAX from FT_TECHNICALDEBT WHERE 	 ID_ACTION = 1 AND ID_TDITEM = 1  and IGNORE = 0 )  S ON T.ID_TIME BETWEEN S.ID_TIME_MIN AND S.ID_TIME_MAX  LEFT JOIN ( SELECT  FT.ID_TIME,COUNT(0) AS TOTAL_ADD_CS_ALL_DEV FROM FT_TECHNICALDEBT FT (NOLOCK) WHERE ID_ACTION = 1   AND ID_TDITEM = 1 and IGNORE = 0  GROUP BY  FT.ID_TIME ) AS CS_ALL_DEV ON T.ID_TIME = CS_ALL_DEV.ID_TIME  LEFT JOIN ( SELECT  FT.ID_TIME,COUNT(0) AS TOTAL_ADD_CS_DEV FROM FT_TECHNICALDEBT FT (NOLOCK) WHERE ID_ACTION = 1 AND ID_TDITEM = 1 AND ID_DEVELOPER = {desenvolvedor}  and IGNORE = 0  GROUP BY  FT.ID_TIME ) AS CS_DEV ON T.ID_TIME = CS_DEV.ID_TIME ) AS Q GROUP BY DATA ORDER BY Q.DATA
query_4_1_B = SELECT DISTINCT CONVERT(char(10),CONVERT(DATETIME,SUBSTRING( CONVERT(VARCHAR, A.DATE,112),0,7)+'01',113),126) as DATA , isnull( B.INDICE_DEV,0) INDICE_DEV,C.INDICE_GERAL FROM DM_TIME A   LEFT JOIN ( SELECT CONVERT(char(10),CONVERT(DATETIME,SUBSTRING( CONVERT(VARCHAR, T.DATE,112),0,7)+'01',113),126) as DATA,   CONVERT(DECIMAL(18,2),  CONVERT(DECIMAL(18,2), SUM (EFFORT)) /  CONVERT(DECIMAL(18,2), COUNT (0)))  AS INDICE_DEV   FROM FT_TECHNICALDEBT FT JOIN DM_TIME T ON T.ID_TIME = FT.ID_TIME WHERE ID_ACTION = 1 AND ID_TDITEM = 1 AND ID_DEVELOPER = {desenvolvedor} AND IGNORE = 0 GROUP BY  CONVERT(char(10),CONVERT(DATETIME,SUBSTRING( CONVERT(VARCHAR, T.DATE,112),0,7)+'01',113),126)   ) AS B  ON CONVERT(char(10),CONVERT(DATETIME,SUBSTRING( CONVERT(VARCHAR, A.DATE,112),0,7)+'01',113),126) = B.DATA LEFT JOIN ( SELECT CONVERT(char(10),CONVERT(DATETIME,SUBSTRING( CONVERT(VARCHAR, T.DATE,112),0,7)+'01',113),126) as DATA,   CONVERT(DECIMAL(18,2),  CONVERT(DECIMAL(18,2), SUM (EFFORT)) /  CONVERT(DECIMAL(18,2), COUNT (0)))  AS INDICE_GERAL   FROM FT_TECHNICALDEBT FT JOIN DM_TIME T ON T.ID_TIME = FT.ID_TIME WHERE ID_ACTION = 1 AND ID_TDITEM = 1 AND IGNORE = 0 GROUP BY  CONVERT(char(10),CONVERT(DATETIME,SUBSTRING( CONVERT(VARCHAR, T.DATE,112),0,7)+'01',113),126)  ) C  ON CONVERT(char(10),CONVERT(DATETIME,SUBSTRING( CONVERT(VARCHAR, A.DATE,112),0,7)+'01',113),126) = C.DATA WHERE B.INDICE_DEV IS NOT NULL OR C.INDICE_GERAL IS NOT NULL ORDER BY 1 ASC
query_5_1 =  SELECT   T.DATE as DATA,  coUNT(0) AS TOTAL_ADD_CS  FROM FT_TECHNICALDEBT FT (NOLOCK)  JOIN DM_TIME T (NOLOCK)  ON T.ID_TIME = FT.ID_TIME  WHERE  ID_ACTION = 1    AND ID_TDITEM = 1 and ignore = 0 GROUP BY T.DATE having coUNT(0) < 35000 ORDER BY 1 ASC
hipotese = SELECT D.ID_DEVELOPER,  ISNULL(ADD_.TOTAL,0) AS TOTAL_ADD,  ISNULL(REM_.TOTAL,0) AS TOTAL_REM ,  COMM_.TOTAL_COMMITS   FROM DM_DEVELOPER D  LEFT JOIN ( SELECT ID_DEVELOPER ,ID_ACTION , COUNT(0) AS TOTAL  FROM FT_TECHNICALDEBT WHERE ID_TDITEM = 1 AND ID_ACTION = 1     AND IGNORE = 0 GROUP BY ID_DEVELOPER ,ID_ACTION ) AS ADD_  ON ADD_.ID_DEVELOPER = D.ID_DEVELOPER  LEFT JOIN ( SELECT ID_DEVELOPER ,ID_ACTION , COUNT(0) AS TOTAL FROM FT_TECHNICALDEBT  WHERE ID_TDITEM = 1 AND ID_ACTION = 2   AND IGNORE = 0 GROUP BY ID_DEVELOPER ,ID_ACTION ) AS REM_  ON REM_.ID_DEVELOPER = D.ID_DEVELOPER  JOIN ( SELECT ID_DEVELOPER , COUNT(0) AS TOTAL_COMMITS  FROM DM_COMMITS GROUP BY ID_DEVELOPER ) AS COMM_  ON COMM_.ID_DEVELOPER = D.ID_DEVELOPER
normalidade = SELECT D.ID_DEVELOPER,  ISNULL(ADD_.TOTAL,0) AS TOTAL_ADD FROM DM_DEVELOPER D  LEFT JOIN ( SELECT ID_DEVELOPER ,ID_ACTION , COUNT(0) AS TOTAL  FROM FT_TECHNICALDEBT WHERE ID_TDITEM = 1 AND ID_ACTION = 1     AND IGNORE = 0 GROUP BY ID_DEVELOPER ,ID_ACTION ) AS ADD_  ON ADD_.ID_DEVELOPER = D.ID_DEVELOPER
developer = SELECT TOP 1 ID_DEVELOPER, COUNT(0) FROM FT_TECHNICALDEBT WHERE ID_ACTION = 1 AND ID_TDITEM = 1 AND IGNORE = 0 GROUP BY ID_DEVELOPER ORDER BY 2 DESC
ignore_update = 'UPDATE FT_TECHNICALDEBT SET IGNORE = 1 WHERE {0}'
ignore_select = 'SELECT * FROM FT_TECHNICALDEBT_IGNORE_CONDITION'
revert_database = 'TRUNCATE TABLE [dbo].[FT_TECHNICALDEBT];TRUNCATE TABLE [dbo].[FT_TECHNICALDEBT_IGNORE_CONDITION];TRUNCATE TABLE [dbo].DM_ACTION;TRUNCATE TABLE [dbo].DM_COMMITS;TRUNCATE TABLE [dbo].DM_DEVELOPER;TRUNCATE TABLE [dbo].DM_PROJECT;TRUNCATE TABLE [dbo].DM_RULE;TRUNCATE TABLE [dbo].DM_SEVERITY;TRUNCATE TABLE [dbo].DM_TDITEM;TRUNCATE TABLE [dbo].DM_TIME;TRUNCATE TABLE [dbo].DM_VERSION;TRUNCATE TABLE [dbo].ORGANIZATION;TRUNCATE TABLE [dbo].ORGANIZATION_PROJECT;TRUNCATE TABLE [dbo].PROJECT_VERSION;'